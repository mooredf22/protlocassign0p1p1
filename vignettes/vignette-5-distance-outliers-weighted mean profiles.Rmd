---
title: "Vignette 5: Distance, outlier detection, and weighted mean profile calculation"
author: "Dirk Moore"
date: "`r Sys.Date()`"
#output: rmarkdown::html_vignette
output:
  word_document:
  #  html_document:
  #mathjax:  default
  fig_caption:  true
toc: true
#section_numbering: true
#css: ggsci.css
#output:
#  word_document:
#    reference_docx: word-styles-reference-03.docx
#output: pdf_document
#fontsize: 10pt
vignette: >
  %\VignetteIndexEntry{protlocassign}
  %\VignetteEngine{knitr::rmarkdown}
---

  ```{r setup, include = FALSE}
knitr::opts_chunk$set(
  #collapse = TRUE,
  comment = "",
  fig.width = 4,
  fig.height = 4,
  message = FALSE,
  warning = FALSE,
  tidy.opts = list(
    keep.blank.line = TRUE,
    width.cutoff = 150
  ),
  options(width = 150),
  eval = TRUE
)
```



## Nearest proteins in a data set
We may find the proteins with profiles nearest to a given protein using the function "nearestProts". Distance is computed as the Euclidean distance between profiles. To use the function, we first use the R function `dist` to create a distance matrix for the proteins in a list of mean profiles, such as `protProfileNSA_AT5tmtMS2`. 

```{r, echo=TRUE, eval=TRUE}
library(protlocassign)
distUse <- dist(protProfileNSA_AT5tmtMS2[,1:9], method="euclidean")
```
Then select the protein names:

```{r, echo=TRUE, eval=TRUE}
protsUse <- rownames(protProfileNSA_AT5tmtMS2)
```
Finally, provide a protein name. Here, for the protein "CTSD", we find the 10 nearest proteins.

```{r, echo=TRUE, eval=TRUE}
nearestProts(protName="CTSD", n.nearest=10,  distProts=distUse, protNames=protsUse,
             profile=protProfileNSA_AT5tmtMS2)
```

Instead of using normalized specific amounts, we may transform them to relative specific amounts:

```{r, echo=TRUE, eval=TRUE}
protProfileLevelsRSA <- RSAfromNSA(NSA=protProfileNSA_AT5tmtMS2[,1:9],
                                 NstartMaterialFractions=6, totProt=totProtAT5)
distUseRSA <- dist(protProfileLevelsRSA, method="euclidean")
nearestProts(protName="CTSD", n.nearest=10,  distProts=distUseRSA, protNames=protsUse,
             profile=protProfileLevelsRSA)

```


